# Руководство разработчика - Анализатор отзывов Amazon

## Информация о проекте

**Учебное заведение**: Федеральное государственное автономное образовательное учреждение высшего образования «Национальный исследовательский университет «Высшая школа экономики» Московский институт электроники и математики

**Курс**: Проектный семинар «Python в науке о данных»

**Студенты группы Б241КОТСИС**:
- Мартынов Борис Александрович, e-mail, номер моб. тел.
- Репин Артемий Ильич, e-mail, номер моб. тел.
- Харисов Денис Артурович, fjk5940@gmail.com, 89371660247

**Тема работы**: Анализ отзывов на Amazon

**Руководитель**: Ролич А. Ю.

**Год**: 2025

## Требования к разработке

### Версия Python
- Python 3.8 или выше

### Обязательные библиотеки
- **tkinter**: GUI framework
- **matplotlib** ≥ 3.3: визуализация данных
- **pandas** ≥ 1.1: обработка данных
- **numpy** ≥ 1.19: численные вычисления
- **configparser**: конфигурация
- **pathlib**: работа с путями
- **json**: парсинг JSON
- **pickle**: сериализация данных
- **re**: регулярные выражения
- **collections**: структуры данных
- **datetime**: работа с датами

### Файл requirements.txt
```
matplotlib>=3.3
pandas>=1.1
numpy>=1.19
```

## Архитектура приложения

Приложение построено по модульной архитектуре с четкой структурой функций.

### Основные модули и функции
| Функция                     | Назначение                                                                 |
|-----------------------------|---------------------------------------------------------------------------|
| `load_config()`             | Загружает настройки из config.ini с значениями по умолчанию               |
| `create_main_window()`      | Создает главное окно приложения с заданными размерами                     |
| `setup_ui()`                | Настраивает интерфейс пользователя с вкладками                            |
| `setup_reviewers_tab()`     | Создает интерфейс управления рецензентами                                 |
| `setup_products_tab()`      | Создает интерфейс управления продуктами                                   |
| `setup_reviews_tab()`       | Создает интерфейс управления отзывами                                     |
| `setup_analysis_tab()`      | Создает интерфейс аналитики с графиками                                   |
| `load_data()`               | Загружает данные из pickle файлов при запуске                             |
| `save_data()`               | Сохраняет данные в бинарном формате                                       |
| `load_jsonl()`              | Импортирует данные из JSONL файлов Amazon                                 |
| `process_review_data()`     | Обрабатывает и нормализует данные отзыва                                  |
| `refresh_tables()`          | Обновляет отображение таблиц в интерфейсе                                 |
| `add_reviewer()`            | Добавляет нового рецензента через диалог                                  |
| `delete_reviewer()`         | Удаляет выбранного рецензента                                             |
| `add_product()`             | Добавляет новый продукт через диалог                                      |
| `delete_product()`          | Удаляет выбранный продукт                                                 |
| `add_review()`              | Добавляет новый отзыв через диалог                                        |
| `delete_review()`           | Удаляет выбранный отзыв                                                   |
| `analyze_ratings()`         | Создает гистограмму распределения рейтингов                               |
| `analyze_top_products()`    | Создает график топ-продуктов по отзывам                                   |
| `analyze_customer_satisfaction()` | Анализирует частоту слов в положительных отзывах                    |
| `main()`                    | Точка входа в программу                                                  |

## Структура данных

### Глобальные переменные
- **Хранилища данных**:
  - `reviewers`: словарь рецензентов `{ID: {name, total_reviews, total_rating}}`
  - `products`: словарь продуктов `{ASIN: {name, category, total_reviews, total_rating}}`
  - `reviews`: словарь отзывов `{ID: {reviewer_id, asin, rating, date, summary, text}}`
- **Интерфейс**:
  - `root`: главное окно Tkinter
  - `notebook`: контейнер вкладок
  - `reviewers_tree`, `products_tree`, `reviews_tree`: таблицы данных
  - `plot_frame`: область для отображения графиков
- **Конфигурация**:
  - `config`: объект ConfigParser с настройками
  - `data_dir`: путь к директории данных

### Структура каталогов
```
python/
├── .idea/
│   └── ...
├── notes/                  # Руководства
│   └── ...
├── scripts/                # Главная папка с функциями
│   └── main.py            # Главный скрипт с функциями
├── tests/                 # Папка с тестовыми файлами
│   └── ...
├── data/                  # Папка для хранения данных
│   ├── reviewers.pkl      # Сериализованные рецензенты
│   ├── products.pkl       # Сериализованные продукты
│   └── reviews.pkl        # Сериализованные отзывы
└── config.ini             # Файл конфигурации
```

## Особенности реализации

### Обработка JSONL файлов
Функция `load_jsonl()`:
- Поддерживает множественные кодировки (UTF-8, CP1251, Latin1)
- Обрабатывает файлы построчно
- Пакетная обработка с обновлением интерфейса каждые 1000 записей
- Обработка ошибок парсинга JSON

### Нормализация данных
Функция `process_review_data()`:
- Создает справочники рецензентов и продуктов
- Рассчитывает агрегированную статистику (количество отзывов, средние рейтинги)
- Усекает длинные тексты для отображения в интерфейсе

### Анализ текста
Функция `analyze_customer_satisfaction()`:
- Фильтрует по положительным отзывам (rating > 3)
- Очищает текст от знаков препинания
- Удаляет стоп-слова из предопределенного списка `STOP_WORDS`
- Подсчитывает частоту слов с помощью `collections.Counter`

### Визуализация данных
- Используется `matplotlib` с интеграцией в Tkinter через `FigureCanvasTkAgg`
- Настраиваемые цвета через конфигурацию
- Автоматическая очистка предыдущих графиков

## Конфигурация

### Файл config.ini
```ini
[DATABASE]
data_directory = data
reviewers_file = reviewers.pkl
products_file = products.pkl
reviews_file = reviews.pkl

[INTERFACE]
window_title = Анализатор отзывов
window_width = 1200
window_height = 800
max_reviews_display = 100

[ANALYSIS]
top_products_count = 10
top_reviewers_count = 10
histogram_bins = 5
chart_colors = skyblue,lightgreen,orange

[FILES]
jsonl_extension = *.json
supported_encodings = utf-8,cp1251,latin1

[APPEARANCE]
tab_padding_x = 10
tab_padding_y = 10
button_padding = 5
table_column_width = 150
```

### Значения по умолчанию
- Все настройки имеют значения по умолчанию в функции `load_config()`
- Обеспечивается работоспособность даже при отсутствии `config.ini`

## Обработка ошибок
- Все операции с файлами обернуты в `try-except` блоки
- Используются `messagebox` для уведомления об ошибках
- Валидация данных в диалогах ввода
- Проверка существования данных перед анализом

## Производительность
- Пакетная обработка больших файлов
- Ограничение отображаемых записей в таблицах
- Использование `pickle` для быстрого сохранения/загрузки
- Обновление интерфейса при длительных операциях